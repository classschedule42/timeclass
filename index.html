<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡∏∞‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      background-color: #f9efd6;
      font-family: sans-serif;
      line-height: 1.4;
    }

    #homeworkButton {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      background: transparent;
      border: none;
      cursor: pointer;
    }

    #homeworkButton img {
      width: 50px;
      height: 50px;
    }

    #homeworkSidebar {
      position: fixed;
      top: 0;
      right: -100%;
      width: 90%;
      max-width: 350px;
      height: 100%;
      background-color: #fff;
      box-shadow: -2px 0 10px rgba(0, 0, 0, 0.2);
      padding: 20px;
      transition: right 0.4s ease;
      overflow-y: auto;
      z-index: 999;
    }

    #homeworkSidebar.open {
      right: 0;
    }

    #homeworkSidebar h3 {
      margin-top: 0;
    }

    .homeworkItem {
      background-color: #f0f0f0;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
      font-size: 14px;
    }

    #imageContainer {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      height: auto;
      padding: 10px;
    }

    #scheduleImage {
      display: block;
      max-width: 100%;
      height: auto;
      transition: transform 0.5s ease;
      object-fit: contain;
    }

    @media (max-width: 767px) {
      #scheduleImage {
        transform: rotate(90deg);
      }
    }

    #dutySection {
      padding: 15px;
    }

    .table-wrapper {
      overflow-x: auto;
    }

    table {
      width: 100%;
      min-width: 400px;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    th, td {
      border: 1px solid #ccc;
      text-align: left;
      padding: 10px;
      font-size: 14px;
    }

    th {
      background-color: #333;
      color: white;
    }

    .clickable-number {
      cursor: pointer;
      background-color: #f0f0f0;
      border: none;
      padding: 5px 10px;
      margin: 2px;
      border-radius: 5px;
      font-size: 14px;
    }

    .clickable-number:hover {
      background-color: #ddd;
    }

    .today { background-color: #a4f9a4 !important; }
    .tomorrow { background-color: #fff48f !important; }
    .normal { background-color: #eee !important; }
    .weekend { background-color: #fff !important; }

    #legend {
      margin-top: 15px;
      font-size: 14px;
    }

    .legend-item {
      display: inline-block;
      margin-right: 15px;
    }

    .legend-color {
      display: inline-block;
      width: 16px;
      height: 16px;
      vertical-align: middle;
      margin-right: 5px;
      border: 1px solid #ccc;
    }

    .color-today { background-color: #a4f9a4; }
    .color-tomorrow { background-color: #fff48f; }
  </style>
</head>
<body>

  <button id="homeworkButton">
    <img src="icon.png" alt="Homework Icon">
  </button>

  <div id="homeworkSidebar">
    <h3>üìö ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏á‡∏≤‡∏ô</h3>
    <div id="homeworkList"></div>
  </div>

  <div id="imageContainer" data-aos="zoom-out">
    <img id="scheduleImage" src="0.png" alt="‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô">
  </div>

  <div id="dutySection">
    <h2>‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ß‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î</h2>
    <div class="table-wrapper">
      <table>
        <thead><tr><th>‡∏ß‡∏±‡∏ô</th><th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç</th></tr></thead>
        <tbody id="duty-table"></tbody>
      </table>
    </div>
    <div id="legend">
      <div class="legend-item"><span class="legend-color color-today"></span>üü¢ ‡πÄ‡∏ß‡∏£‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
      <div class="legend-item"><span class="legend-color color-tomorrow"></span>üü° ‡πÄ‡∏ß‡∏£‡∏û‡∏£‡∏∏‡πà‡∏á‡∏ô‡∏µ‡πâ</div>
    </div>
  </div>

  <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
  <script>
    AOS.init();

    const imageElement = document.getElementById("scheduleImage");
    const imageContainer = document.getElementById("imageContainer");

    const periods = ["08:40", "09:35", "10:30", "11:25", "12:20", "13:15", "14:10", "15:05", "16:00"];
    let previousIndex = -1;

    function getImageIndexFromDate(date) {
      const day = date.getDay();
      const currentMinutes = date.getHours() * 60 + date.getMinutes();

      if (day === 0 || day === 6) return 0;
      if (currentMinutes < 8 * 60 + 40) return 0;

      const timesInMinutes = periods.map(time => {
        const [h, m] = time.split(":").map(Number);
        return h * 60 + m;
      });

      let periodIndex = -1;
      for (let i = 0; i < timesInMinutes.length; i++) {
        if (currentMinutes >= timesInMinutes[i]) {
          periodIndex = i;
        }
      }

      return periodIndex === -1 ? 0 : ((day - 1) * 10) + (periodIndex + 1);
    }

    function updateImage() {
      const now = new Date();
      const imgIndex = getImageIndexFromDate(now);
      if (imgIndex !== previousIndex) {
        imageElement.src = `${imgIndex}.png`;
        previousIndex = imgIndex;
        imageContainer.setAttribute("data-aos", "zoom-out");
        imageContainer.classList.remove("aos-animate");
        void imageContainer.offsetWidth;
        imageContainer.classList.add("aos-animate");
      }
    }

    updateImage();
    setInterval(updateImage, 10000);

    const dutyData = {
      "‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå": [1, 4, 10, 13, 19, 22, 30, 35],
      "‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£": [5, 9, 12, 27, 28, 29, 33, 37],
      "‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò": [7, 8, 15, 20, 25, 32, 34, 39],
      "‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ": [11, 16, 17, 18, 21, 23, 26, 31],
      "‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå": [2, 3, 6, 14, 24, 36, 38, 40]
    };

    const nameMap = {
      1: "1.‡∏ô‡∏≤‡∏¢ ‡∏Å‡∏≤‡∏£‡∏¥‡∏ô ‡∏ä‡∏∑‡πà‡∏ô‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤", 2: "2.‡∏ô‡∏≤‡∏¢ ‡πÄ‡∏à‡∏©‡∏é‡∏≤ ‡πÉ‡∏à‡∏ô‡πâ‡∏≠‡∏¢", 3: "3.‡∏ô‡∏≤‡∏¢ ‡∏ì‡∏±‡∏ê‡∏Å‡∏£ ‡∏°‡∏π‡∏•‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥",
      // ... (‡∏ï‡πà‡∏≠‡∏à‡∏ô‡∏Ñ‡∏£‡∏ö 40 ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏î‡∏¥‡∏°)
      40: "40.‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß ‡∏ß‡∏£‡∏£‡∏ì‡∏ò‡∏Å‡∏≤‡∏ç‡∏ì‡πå ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÄ‡∏ó‡∏û‡∏≤"
    };

    function createDutyTable() {
      const tbody = document.getElementById("duty-table");
      const now = new Date();
      const todayIndex = now.getDay();
      const dutyDays = Object.keys(dutyData);

      dutyDays.forEach((dayLabel, i) => {
        const row = document.createElement("tr");
        let className = "normal";
        if (todayIndex === 0 || todayIndex === 6) className = "weekend";
        else if (i === todayIndex - 1) className = "today";
        else if (i === todayIndex) className = "tomorrow";
        row.classList.add(className);

        const dayCell = document.createElement("td");
        dayCell.textContent = dayLabel;

        const numbersCell = document.createElement("td");
        dutyData[dayLabel].sort((a, b) => a - b).forEach(num => {
          const btn = document.createElement("button");
          btn.textContent = num;
          btn.className = "clickable-number";
          btn.addEventListener("click", () => {
            btn.textContent = isNaN(btn.textContent) ? num : nameMap[num] || `‡∏ä‡∏∑‡πà‡∏≠ ${num}`;
          });
          numbersCell.appendChild(btn);
        });

        row.appendChild(dayCell);
        row.appendChild(numbersCell);
        tbody.appendChild(row);
      });
    }

    createDutyTable();

    const homeworkData = [
      {
        subject: "‡∏ß‡∏¥‡∏ä‡∏≤ : ‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢",
        description: "‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ô‡∏õ‡∏¥‡∏î‡πÄ‡∏ó‡∏≠‡∏°‡∏ñ‡∏∂‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ó‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡πá‡∏ô",
        dueDate: "2025-05-16T14:47:04"
      },
    ];

    function renderHomework() {
      const list = document.getElementById("homeworkList");
      list.innerHTML = "";
      homeworkData.forEach(hw => {
        const div = document.createElement("div");
        div.className = "homeworkItem";
        div.innerHTML = `<strong>${hw.subject}</strong><br>${hw.description}<br><small>üìÖ ${new Date(hw.dueDate).toLocaleString('th-TH')}</small>`;
        list.appendChild(div);
      });
    }

    const homeworkBtn = document.getElementById("homeworkButton");
    const sidebar = document.getElementById("homeworkSidebar");

    homeworkBtn.addEventListener("click", () => {
      sidebar.classList.toggle("open");
    });

    renderHomework();
  </script>
</body>
</html>
